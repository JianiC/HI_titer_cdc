group_by()
#select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(count=n())
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name"=a"g_strain_name"))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())%>%
ggplot(aes(x=count))+
geom_histogram()+
scale_x_continuous(
breaks = seq(0, 100, 5))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())%>%
ggplot(aes(x=count))+
geom_histogram()+
scale_x_continuous(
breaks = seq(0, 50, 2))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())%>%
ggplot(aes(x=count))+
geom_histogram()+
scale_x_continuous(
limits =  = seq(0, 50, 2))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())%>%
ggplot(aes(x=count))+
geom_histogram()+
scale_x_continuous(
limits = seq(0, 50, 2))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())%>%
ggplot(aes(x=count))+
geom_histogram()+
scale_x_continuous( breaks = seq(0, 50, 2),
limits = c(0,50))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
group_by(ag_collection_year)%>%
summarise(count=n())
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)%>%
group_by(ag_collection_year)%>%
slice(1:100)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)%>%
group_by(ag_collection_year)%>%
summarise(year_count=n())
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))->test
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)->test
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)->test2
View(test2)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)%>%
group_by(ag_collection_year)%>%
summarise(year_count=n())
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)%>%
group_by(ag_collection_year)%>%
summarise(year_count=n())%>%
slice(1:50)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)%>%
group_by(ag_collection_year)%>%
slice(1:50)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)%>%
group_by(ag_collection_year)%>%
slice(1:50)->filter_seq
View(filter_seq)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))->test1
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())%>%
merge(uga_titer_2020_H3, by=c("ag_strain_name","ag_strain_name"))%>%
distinct(ag_strain_name,.keep_all= TRUE)->test2
## preapare HI titer data
## filter from influenza subtype and collection year
HI_titer_raw<-read.csv("uga_titers_2010_onward_H3.csv")
HI_titer_raw %>%
filter(ag_ha_type=="H3")%>%
mutate(ag_collection_date2=as_date(ag_collection_date,format="%m/%d/%y"))%>%
filter(ag_collection_date2>="2010-9-1" & ag_collection_date2 <= "2020-5-1")-> uga_titer_2020_H3
duplicated(uga_titer_2020_H3, by=c("ag_strain_name", "sr_strain_name"))->test
uga_titer_2020_H3[test,]
subset(uga_titer_2020_H3,duplicated(by=c("ag_strain_name","sr_strain_name")))-> duplicate_records
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
#select(ag_strain_name,sr_strain_name,titer_value)%>%
#distinct(ag_strain_name,sr_strain_name)%>%
group_by(ag_strain_name,sr_strain_name,ag_entry_id,sr_entry_id)%>%
mutate(dupe = n()>1)%>%
filter(dupe=="TRUE")->test2
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
mutate(ag_strain_name2=paste0(ag_strain_name,"_",ag_entry_id))%>%
mutate(sr_strain_name2=paste0(sr_strain_name,"_",sr_entry_id))%>%
select(ag_strain_name2,sr_strain_name2,titer_value)%>%
spread(key = "sr_strain_name2", value = "titer_value")->test_matrix
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))->test_matrix2
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())-> HI_strain_count
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(ag_strain_name)%>%
summarise(count=n())%>%
ggplot(aes(x=count))+
geom_histogram()+
scale_x_continuous(limits = c(0,50,2))
## get strain name
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_strain_taxa=paste0(ag_epi_isolate_id,"|",ag_strain_name))->uga_titer_2020_H3
View(uga_titer_2020_H3)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())->ag_srcount
View(ag_srcount)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())
HI_titer_raw<-read.csv("uga_titers_2010_onward_H3.csv")
HI_titer_raw %>%
filter(ag_ha_type=="H3")%>%
mutate(ag_collection_date2=as_date(ag_collection_date,format="%m/%d/%y"))%>%
filter(ag_collection_date2>="2010-9-1" & ag_collection_date2 <= "2020-5-1")-> uga_titer_2020_H3
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
group_by(ag_strain_name)%>%
summarise(sr_count=n())->ag_srcount
View(ag_srcount)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,.keep_all= TRUE)%>%
mutate(ag_strain_taxa=paste0(ag_epi_isolate_id,"|",ag_strain_name))->uga_titer_strain_2020_H3
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))
View(ag_srcount)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
group_by(ag_collection_year)%>%
slice(1:50)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
group_by(ag_collection_year)%>%
slice(1:50)->uga_titer_strain_filteryear
View(uga_titer_strain_filteryear)
View(ag_srcount)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(sr_count)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(desc(sr_count))%>%
group_by(ag_collection_year)%>%
slice(1:50)->uga_titer_strain_filteryear
View(uga_titer_strain_filteryear)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))->tes_matrix3
View(tes_matrix3)
titertable <- read.titerTable("2010_2020_raw_titer.csv")
packages <- c("tidyverse",
"dplyr",
"lubridate",
"Racmacs",
"ggplot2",
"ggpubr",
"cowplot",
"Racmacs")
lapply(packages, library, character.only = TRUE)
titertable <- read.titerTable("2010_2020_raw_titer.csv")
View(titertable)
View(tes_matrix3)
write.csv(tes_matrix3,"2010_2020_raw_titer_filter.csv")
titertable <- read.titerTable("2010_2020_raw_titer_filter.csv")
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
View(titertable)
write.csv(tes_matrix3,"2010_2020_raw_titer_filter.csv",row.names = FALSE)
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
titertable <- read.titerTable("2010_2020_raw_titer_filter.csv")
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
View(titertable)
View(titertable)
view(map)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(srstrain_name)%>%
summarise(count=n())->sr_strain_count
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
group_by(sr_strain_name)%>%
summarise(count=n())->sr_strain_count
View(sr_strain_count)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
group_by(sr_strain_name)%>%
summarise(count=n())->sr_strain_count
View(sr_strain_count)
map_file <- system.file("extdata/h3map2004.ace", package = "Racmacs")
map <- read.acmap(map_file)
view(map)
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
view(map)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(desc(sr_count))%>%
group_by(ag_collection_year)%>%
slice(1:30)->uga_titer_strain_filteryear
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))->tes_matrix3
write.csv(tes_matrix3,"2010_2020_raw_titer_filter.csv",row.names = FALSE)
titertable <- read.titerTable("2010_2020_raw_titer_filter.csv")
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
view(map)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(desc(sr_count))%>%
group_by(ag_collection_year)%>%
slice(1:10)->uga_titer_strain_filteryear
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))->tes_matrix3
View(tes_matrix3)
write.csv(tes_matrix3,"2010_2020_raw_titer_filter.csv",row.names = FALSE)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(desc(titer_value,sr_count))
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(desc(titer_value,sr_count))%>%
group_by(ag_collection_year)%>%
slice(1:10)->uga_titer_strain_filteryear
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))->tes_matrix3
write.csv(tes_matrix3,"2010_2020_raw_titer_filter.csv",row.names = FALSE)
titertable <- read.titerTable("2010_2020_raw_titer_filter.csv")
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
view(map)
uga_titer_strain_2020_H3%>%
merge(ag_srcount,by=c("ag_strain_name","ag_strain_name"))%>%
mutate(ag_collection_year=year(ag_collection_date2))%>%
arrange(desc(titer_value,sr_count))%>%
group_by(ag_collection_year)%>%
slice(1:30)->uga_titer_strain_filteryear
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)%>%
filter(ag_strain_name %in% uga_titer_strain_filteryear$ag_strain_name)%>%
select(ag_strain_name,sr_strain_name,titer_value)%>%
spread(key = "sr_strain_name", value = "titer_value")%>%
mutate_all(~replace(., is.na(.), "*"))->tes_matrix3
write.csv(tes_matrix3,"2010_2020_raw_titer_filter.csv",row.names = FALSE)
titertable <- read.titerTable("2010_2020_raw_titer_filter.csv")
map <- acmap(table = titertable)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
view(map)
map_file
View(map)
selectedOptimization(map)
antigentic_distance<-mapDistances(map)
View(antigentic_distance)
p <- ggacmap(map)
uga_titer_2020_H3%>%
mutate(ag_strain_name=gsub(" ","_",ag_strain_name))%>%
distinct(ag_strain_name,sr_strain_name,.keep_all= TRUE)
write.table(uga_titer_strain_filteryear$ag_strain_taxa,"HI_titer_yearfilter_strain.txt",sep="\t",row.names=FALSE)
uga_titer_strain_filteryear%>%
select(ag_strain_name,ag_collection_year)->meta_year
map+
ggplot(data=meta_year,color=ag_colelction_year)
map+
ggplot(data=meta_year,color=ag_colelction_year)+
geom_point()
map <- acmap(table = titertable)
view(map)
map <- optimizeMap(
map = map,
number_of_dimensions = 2,
number_of_optimizations = 500,
minimum_column_basis = "none"
)
selectedOptimization(map)
view(map)
agCoords(map, optimization_number = 1)
agCoords(map, optimization_number = 1)%>%
merge(uga_titer_strain_filteryear,by=c("ag_strain_name","ag_strain_name"))
